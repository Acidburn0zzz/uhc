INCLUDE "Core/CommonPred.ag"
ATTR CExpr [ | | mbFunVar: {Maybe HsName} ]

SEM CExpr
  | Var         lhs         .   mbFunVar    =   @mbVar
  | App         lhs         .   mbFunVar    =   @func.mbFunVar
  | * - Var App Ann CaseAltFail
  				lhs         .   mbFunVar    =   Nothing

ATTR CExpr [ | | argL: {[CBound]} ]

SEM CExpr
  | App         loc         .   argL        =   @arg.cTrf : @func.argL
  | * - App Ann CaseAltFail
  				lhs         .   argL        =   []

ATTR CAlt CPat [ | | mbCTag: {Maybe CTag} ]

SEM CPat
  | Con			lhs			.	mbCTag		=	Just @tag
  | * - Con	Ann
  				lhs			.	mbCTag		=	Nothing

