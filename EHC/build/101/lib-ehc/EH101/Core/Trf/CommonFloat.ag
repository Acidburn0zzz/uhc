
ATTR CExpr [ | | isClosurableExpr: Bool ]

SEM CExpr
  | Case
    Let
    TupDel
    TupIns
    TupUpd
                lhs         .   isClosurableExpr    =   True

  | Lam
    Var
    Int
    Char
    String
    Tup
    FFI
    CaseAltFail
    Hole
    HoleLet
    CoeArg
    ImplsApp
    ImplsLam
    Integer
                lhs         .   isClosurableExpr    =   False

  | App
                lhs         .   isClosurableExpr    =   False


SEM CBound
  | Bind        loc         .  isClosurableBind =   (  @lhs.letBindingsCateg /= CBindCateg_Strict
                                                    && @expr.isClosurableExpr
                                                    )


