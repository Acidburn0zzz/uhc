%% ODER: format ==         = "\mathrel{==}"
%% ODER: format /=         = "\neq "
%
%
\makeatletter
\@ifundefined{lhs2tex.lhs2tex.sty.read}%
  {\@namedef{lhs2tex.lhs2tex.sty.read}{}%
   \newcommand\SkipToFmtEnd{}%
   \newcommand\EndFmtInput{}%
   \long\def\SkipToFmtEnd#1\EndFmtInput{}%
  }\SkipToFmtEnd

\newcommand\ReadOnlyOnce[1]{\@ifundefined{#1}{\@namedef{#1}{}}\SkipToFmtEnd}
\usepackage{amstext}
\usepackage{amssymb}
\usepackage{stmaryrd}
\DeclareFontFamily{OT1}{cmtex}{}
\DeclareFontShape{OT1}{cmtex}{m}{n}
  {<5><6><7><8>cmtex8
   <9>cmtex9
   <10><10.95><12><14.4><17.28><20.74><24.88>cmtex10}{}
\DeclareFontShape{OT1}{cmtex}{m}{it}
  {<-> ssub * cmtt/m/it}{}
\newcommand{\texfamily}{\fontfamily{cmtex}\selectfont}
\DeclareFontShape{OT1}{cmtt}{bx}{n}
  {<5><6><7><8>cmtt8
   <9>cmbtt9
   <10><10.95><12><14.4><17.28><20.74><24.88>cmbtt10}{}
\DeclareFontShape{OT1}{cmtex}{bx}{n}
  {<-> ssub * cmtt/bx/n}{}
\newcommand{\tex}[1]{\text{\texfamily#1}}	% NEU

\newcommand{\Sp}{\hskip.33334em\relax}


\newcommand{\Conid}[1]{\mathit{#1}}
\newcommand{\Varid}[1]{\mathit{#1}}
\newcommand{\anonymous}{\kern0.06em \vbox{\hrule\@width.5em}}
\newcommand{\plus}{\mathbin{+\!\!\!+}}
\newcommand{\bind}{\mathbin{>\!\!\!>\mkern-6.7mu=}}
\newcommand{\rbind}{\mathbin{=\mkern-6.7mu<\!\!\!<}}% suggested by Neil Mitchell
\newcommand{\sequ}{\mathbin{>\!\!\!>}}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\usepackage{polytable}

%mathindent has to be defined
\@ifundefined{mathindent}%
  {\newdimen\mathindent\mathindent\leftmargini}%
  {}%

\def\resethooks{%
  \global\let\SaveRestoreHook\empty
  \global\let\ColumnHook\empty}
\newcommand*{\savecolumns}[1][default]%
  {\g@addto@macro\SaveRestoreHook{\savecolumns[#1]}}
\newcommand*{\restorecolumns}[1][default]%
  {\g@addto@macro\SaveRestoreHook{\restorecolumns[#1]}}
\newcommand*{\aligncolumn}[2]%
  {\g@addto@macro\ColumnHook{\column{#1}{#2}}}

\resethooks

\newcommand{\onelinecommentchars}{\quad-{}- }
\newcommand{\commentbeginchars}{\enskip\{-}
\newcommand{\commentendchars}{-\}\enskip}

\newcommand{\visiblecomments}{%
  \let\onelinecomment=\onelinecommentchars
  \let\commentbegin=\commentbeginchars
  \let\commentend=\commentendchars}

\newcommand{\invisiblecomments}{%
  \let\onelinecomment=\empty
  \let\commentbegin=\empty
  \let\commentend=\empty}

\visiblecomments

\newlength{\blanklineskip}
\setlength{\blanklineskip}{0.66084ex}

\newcommand{\hsindent}[1]{\quad}% default is fixed indentation
\let\hspre\empty
\let\hspost\empty
\newcommand{\NB}{\textbf{NB}}
\newcommand{\Todo}[1]{$\langle$\textbf{To do:}~#1$\rangle$}

\EndFmtInput
\makeatother
%
%% configuration




%% end of configuration

%% CONFIG: Omitted material excluded


%% CONFIG: As article


% format * = "\times "
% subst inline a  	= "\ensuremath{{}\allowforspacecorrection " a "}"
% subst varid a  	= a "{}\allowforspacecorrection "









%% handling of `






% various keywords













% format CnstrVarpi	= Cnstr "^{" varpi "}"


















% format <=> 			= "\mathrel{\cong}"
% format <+-> 			= "\setbox0=\hbox{\ensuremath{\mathrel{\vartriangle}}}\copy0\kern-.4\wd0\mathrel{\triangledown}"
% format +	 			= ","
% format ++	 			= ","



% format fiopt			= "{\xi}"





% format ANY				= "\makebox[0cm][l]{\(\top\)}\bot{}"




% format ftv				= "\ftv "










%% acronyms



\rulerCmdDef{rules4.ANN.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C}} }
}
\rulerCmdDef{rules4.ANN.expr.base.e.int}{%
\rulerRule{e.int}{ANN}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.char}{%
\rulerRule{e.char}{ANN}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.var}{%
\rulerRule{e.var}{ANN}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.con}{%
\rulerRule{e.con}{ANN}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.app}{%
\rulerRule{e.app}{ANN}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.app.f}{%
\rulerRule{e.app.f}{ANN}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.let}{%
\rulerRule{e.let}{ANN}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base.e.lam}{%
\rulerRule{e.lam}{ANN}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.scheme}{%
\ensuremath{\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C}} }
}
\rulerCmdDef{rules4.C.expr.base.e.int}{%
\rulerRule{e.int}{C}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.e.char}{%
\rulerRule{e.char}{C}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.e.var}{%
\rulerRule{e.var}{C}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.e.con}{%
\rulerRule{e.con}{C}
{%
\ensuremath{} \overline{ \ensuremath{\Varid{v}} } \ensuremath{} \;\mbox{fresh} \ensuremath{,\;\mid I\mid \equiv \mid } \overline{ \ensuremath{\Varid{v}} } \ensuremath{\mid } 
\\
\ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\equiv (\allowforspacecorrection \sigma } _{ \ensuremath{\mathrm{1}} } \ensuremath{,\mathbin{...},\sigma } _{ \ensuremath{\Varid{n}} } \ensuremath{),\quad [\mskip1.5mu\allowforspacecorrection \sigma } _{ \ensuremath{\mathrm{1}} } \ensuremath{,\mathbin{...},\sigma } _{ \ensuremath{\Varid{n}} } \ensuremath{\mskip1.5mu]\equiv } \overline{ \ensuremath{\Varid{v}} } \ensuremath{} 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\Varid{v}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{)\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.e.app}{%
\rulerRule{e.app}{C}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.e.let}{%
\rulerRule{e.let}{C}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.C.expr.base.e.lam}{%
\rulerRule{e.lam}{C}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu];\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.CG.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.CG.expr.base.e.int}{%
\rulerRule{e.int}{CG}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.char}{%
\rulerRule{e.char}{CG}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.var}{%
\rulerRule{e.var}{CG}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.con}{%
\rulerRule{e.con}{CG}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.app}{%
\rulerRule{e.app}{CG}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.app.f}{%
\rulerRule{e.app.f}{CG}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.let}{%
\rulerRule{e.let}{CG}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.CG.expr.base.e.lam}{%
\rulerRule{e.lam}{CG}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C}} }
}
\rulerCmdDef{rules4.DT.expr.base.e.int}{%
\rulerRule{e.int}{DT}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.char}{%
\rulerRule{e.char}{DT}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.var}{%
\rulerRule{e.var}{DT}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.con}{%
\rulerRule{e.con}{DT}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.app}{%
\rulerRule{e.app}{DT}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.app.f}{%
\rulerRule{e.app.f}{DT}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.let}{%
\rulerRule{e.let}{DT}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.DT.expr.base.e.lam}{%
\rulerRule{e.lam}{DT}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.E.expr.base.scheme}{%
\ensuremath{\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } }
}
\rulerCmdDef{rules4.E.expr.base.e.int}{%
\rulerRule{e.int}{E}
{%
}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\Conid{Int}} 
}
}

\rulerCmdDef{rules4.E.expr.base.e.char}{%
\rulerRule{e.char}{E}
{%
}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\Conid{Char}} 
}
}

\rulerCmdDef{rules4.E.expr.base.e.var}{%
\rulerRule{e.var}{E}
{%
\ensuremath{i\mapsto \sigma \in \Gamma } 
}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.E.expr.base.e.app}{%
\rulerRule{e.app}{E}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma } 
}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.E.expr.base.e.let}{%
\rulerRule{e.let}{E}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma \vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma } 
}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.E.expr.base.e.lam}{%
\rulerRule{e.lam}{E}
{%
\ensuremath{(\allowforspacecorrection i\mapsto \sigma } _{ \ensuremath{i} } \ensuremath{),\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda i\to \Varid{e}\mathbin{:}\sigma } _{ \ensuremath{i} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EP.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.EP.expr.base.e.int}{%
\rulerRule{e.int}{EP}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.char}{%
\rulerRule{e.char}{EP}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.var}{%
\rulerRule{e.var}{EP}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.con}{%
\rulerRule{e.con}{EP}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.app}{%
\rulerRule{e.app}{EP}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.app.f}{%
\rulerRule{e.app.f}{EP}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.let}{%
\rulerRule{e.let}{EP}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EP.expr.base.e.lam}{%
\rulerRule{e.lam}{EP}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\varpi}\Rightarrow \Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{;{\delta}} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv inst} _{ \ensuremath{\pi } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{)} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \anonymous \rightsquigarrow } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\mskip1.5mu]\equiv \Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\to \lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C}} }
}
\rulerCmdDef{rules4.EX.expr.base.e.int}{%
\rulerRule{e.int}{EX}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.char}{%
\rulerRule{e.char}{EX}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.var}{%
\rulerRule{e.var}{EX}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.con}{%
\rulerRule{e.con}{EX}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.app}{%
\rulerRule{e.app}{EX}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-lr};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.app.f}{%
\rulerRule{e.app.f}{EX}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.let}{%
\rulerRule{e.let}{EX}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.EX.expr.base.e.lam}{%
\rulerRule{e.lam}{EX}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.scheme}{%
\ensuremath{\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C}} }
}
\rulerCmdDef{rules4.HM.expr.base.e.int}{%
\rulerRule{e.int}{HM}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.e.char}{%
\rulerRule{e.char}{HM}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.e.var}{%
\rulerRule{e.var}{HM}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{\sigma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv \mathcal{C}} _{ \ensuremath{\Varid{i}} } \ensuremath{\sigma ',\;{\forall} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma '\equiv \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{,\;\mathcal{C}} _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv } \overline{ \ensuremath{[\mskip1.5mu\allowforspacecorrection \Varid{v}\mapsto \Varid{v}} _{ \ensuremath{\Varid{i}} } \ensuremath{\mskip1.5mu]} } \ensuremath{,\;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{i}} } \ensuremath{} } \ensuremath{} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{i}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.e.con}{%
\rulerRule{e.con}{HM}
{%
\ensuremath{} \overline{ \ensuremath{\Varid{v}} } \ensuremath{} \;\mbox{fresh} \ensuremath{,\;\mid I\mid \equiv \mid } \overline{ \ensuremath{\Varid{v}} } \ensuremath{\mid } 
\\
\ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\equiv (\allowforspacecorrection \sigma } _{ \ensuremath{\mathrm{1}} } \ensuremath{,\mathbin{...},\sigma } _{ \ensuremath{\Varid{n}} } \ensuremath{),\quad [\mskip1.5mu\allowforspacecorrection \sigma } _{ \ensuremath{\mathrm{1}} } \ensuremath{,\mathbin{...},\sigma } _{ \ensuremath{\Varid{n}} } \ensuremath{\mskip1.5mu]\equiv } \overline{ \ensuremath{\Varid{v}} } \ensuremath{} 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\Varid{v}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{)\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.e.app}{%
\rulerRule{e.app}{HM}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.e.let}{%
\rulerRule{e.let}{HM}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HM.expr.base.e.lam}{%
\rulerRule{e.lam}{HM}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu];\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HS.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.HS.expr.base.e.int}{%
\rulerRule{e.int}{HS}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.char}{%
\rulerRule{e.char}{HS}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.var}{%
\rulerRule{e.var}{HS}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.con}{%
\rulerRule{e.con}{HS}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.app}{%
\rulerRule{e.app}{HS}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.app.f}{%
\rulerRule{e.app.f}{HS}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.let}{%
\rulerRule{e.let}{HS}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.HS.expr.base.e.lam}{%
\rulerRule{e.lam}{HS}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\varpi}\Rightarrow \Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{;{\delta}} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv inst} _{ \ensuremath{\pi } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{)} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \anonymous \rightsquigarrow } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\mskip1.5mu]\equiv \Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\to \lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C}} }
}
\rulerCmdDef{rules4.I1.expr.base.e.int}{%
\rulerRule{e.int}{I1}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.char}{%
\rulerRule{e.char}{I1}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.var}{%
\rulerRule{e.var}{I1}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.con}{%
\rulerRule{e.con}{I1}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.app}{%
\rulerRule{e.app}{I1}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-lr};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.app.f}{%
\rulerRule{e.app.f}{I1}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.let}{%
\rulerRule{e.let}{I1}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I1.expr.base.e.lam}{%
\rulerRule{e.lam}{I1}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\mathbb{\bbsigma};\sigma \leadsto \mathbb{C};\mathcal{C}} }
}
\rulerCmdDef{rules4.I2.expr.base.e.int}{%
\rulerRule{e.int}{I2}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\Conid{Int};\sigma \leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.char}{%
\rulerRule{e.char}{I2}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\Conid{Char};\sigma \leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.var}{%
\rulerRule{e.var}{I2}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\sigma \leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.con}{%
\rulerRule{e.con}{I2}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C}} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\sigma \leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.app}{%
\rulerRule{e.app}{I2}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\anonymous \to \sigma \leadsto \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{im}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{(\allowforspacecorrection \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{)\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o_{inst-lr};\Gamma ;\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\textit{fi}_{alt}^{+},o_{inst-l}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\Varid{v}\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{} 
\\
\ensuremath{\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\equiv \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.app.f}{%
\rulerRule{e.app.f}{I2}
{%
\ensuremath{\Varid{v}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\anonymous \to \sigma \leadsto \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{im}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{(\allowforspacecorrection \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{)\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{o_{im}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\Varid{v}\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{} 
\\
\ensuremath{\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\equiv \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.let}{%
\rulerRule{e.let}{I2}
{%
\ensuremath{} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \Gamma )} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{t}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu];\mathcal{C}} _{ \ensuremath{\Varid{t}} }^{ \ensuremath{\Varid{ex}} } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{t}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{t}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathbb{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{o_{join};\mathbb{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{} \stackrel{ \ensuremath{\Gamma \;\varphi \;\Varid{elim}} }{ \ensuremath{\vdash } } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{t}} }^{ \ensuremath{\Varid{ex}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{)\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,{\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma \equiv \mathcal{C}} _{ \ensuremath{\Varid{t}} } \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{)\leftarrow \Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\sigma \equiv \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma ){\backslash}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{l}} }^{ \ensuremath{\Varid{ex}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{)\leftarrow \Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,{\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma \equiv \mathcal{C}} _{ \ensuremath{\Varid{q}} } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{l}} }^{ \ensuremath{\Varid{ex}} } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{q}} } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\mathbb{\bbsigma};\sigma \leadsto \mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\mathbb{\bbsigma};\sigma \leadsto \mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.base.e.lam}{%
\rulerRule{e.lam}{I2}
{%
\ensuremath{} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \Gamma )} 
\\
\ensuremath{o_{meet};\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{} \stackrel{ \ensuremath{\varphi \;\Varid{elim}} }{ \ensuremath{\vdash } } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} }^{ \ensuremath{\Varid{k}} } \ensuremath{\leadsto \anonymous } 
\\
\ensuremath{\Varid{v}_{1},\Varid{v}_{2}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},\textit{fi}_{l,r}^{-},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{(\allowforspacecorrection \Varid{v}_{1}\to \Varid{v}_{2})\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \sigma } _{ \ensuremath{\Varid{e}} }^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu];\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\anonymous \equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\equiv \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\backslash \Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{(\allowforspacecorrection \Varid{v}_{1}\to \Varid{v}_{2}))} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\mathrm{3}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\mathrm{3}} } \ensuremath{\equiv \mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\mathcal{C}} _{ \ensuremath{\mathrm{2}} } \ensuremath{(\allowforspacecorrection \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\ogreaterthan \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{)\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
\\
\ensuremath{o_{meet};\mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{} \stackrel{ \ensuremath{\Gamma \;\varphi \;\Varid{elim}} }{ \ensuremath{\vdash } } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{} 
\\
\ensuremath{\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\equiv \mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.K.expr.base.scheme}{%
\ensuremath{\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } }
}
\rulerCmdDef{rules4.K.expr.base.e.int}{%
\rulerRule{e.int}{K}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma } 
}
{%
\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.K.expr.base.e.char}{%
\rulerRule{e.char}{K}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma } 
}
{%
\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.K.expr.base.e.var}{%
\rulerRule{e.var}{K}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma } 
}
{%
\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.K.expr.base.e.con}{%
\rulerRule{e.con}{K}
{%
\ensuremath{} \overline{ \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} }} \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \sigma } _{ \ensuremath{\mathrm{1}} } \ensuremath{,\mathbin{...},\sigma } _{ \ensuremath{\Varid{n}} } \ensuremath{\mskip1.5mu],\quad (\allowforspacecorrection \sigma } _{ \ensuremath{\mathrm{1}} } \ensuremath{,\mathbin{...},\sigma } _{ \ensuremath{\Varid{n}} } \ensuremath{)\equiv \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\mathbin{...}\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{(\allowforspacecorrection ,)\mathbin{:}} \overline{ \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} }} \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.K.expr.base.e.app}{%
\rulerRule{e.app}{K}
{%
\ensuremath{\Gamma ;{\Box}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma } 
\\
\ensuremath{\Gamma ;\sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.K.expr.base.e.let}{%
\rulerRule{e.let}{K}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma } 
}
{%
\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma } 
}
}

\rulerCmdDef{rules4.K.expr.base.e.lam}{%
\rulerRule{e.lam}{K}
{%
\ensuremath{\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\Box}\to {\Box}\leq \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \mskip1.5mu];\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{,\Gamma ;\sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{\Gamma ;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.MD.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.MD.expr.base.e.int}{%
\rulerRule{e.int}{MD}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.char}{%
\rulerRule{e.char}{MD}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.var}{%
\rulerRule{e.var}{MD}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.con}{%
\rulerRule{e.con}{MD}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.app}{%
\rulerRule{e.app}{MD}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.app.f}{%
\rulerRule{e.app.f}{MD}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.let}{%
\rulerRule{e.let}{MD}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.MD.expr.base.e.lam}{%
\rulerRule{e.lam}{MD}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\varpi}\Rightarrow \Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{;{\delta}} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv inst} _{ \ensuremath{\pi } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{)} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \anonymous \rightsquigarrow } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\mskip1.5mu]\equiv \Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\to \lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.NUM.expr.base.e.int}{%
\rulerRule{e.int}{NUM}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.char}{%
\rulerRule{e.char}{NUM}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.var}{%
\rulerRule{e.var}{NUM}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.con}{%
\rulerRule{e.con}{NUM}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.app}{%
\rulerRule{e.app}{NUM}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.app.f}{%
\rulerRule{e.app.f}{NUM}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.let}{%
\rulerRule{e.let}{NUM}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.NUM.expr.base.e.lam}{%
\rulerRule{e.lam}{NUM}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\varpi}\Rightarrow \Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{;{\delta}} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv inst} _{ \ensuremath{\pi } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{)} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \anonymous \rightsquigarrow } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\mskip1.5mu]\equiv \Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\to \lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.P.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.P.expr.base.e.int}{%
\rulerRule{e.int}{P}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.char}{%
\rulerRule{e.char}{P}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.var}{%
\rulerRule{e.var}{P}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.con}{%
\rulerRule{e.con}{P}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.app}{%
\rulerRule{e.app}{P}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.app.f}{%
\rulerRule{e.app.f}{P}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.let}{%
\rulerRule{e.let}{P}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.P.expr.base.e.lam}{%
\rulerRule{e.lam}{P}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\varpi}\Rightarrow \Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{;{\delta}} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv inst} _{ \ensuremath{\pi } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{)} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \anonymous \rightsquigarrow } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\mskip1.5mu]\equiv \Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\to \lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.TS.expr.base.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma \leadsto \mathcal{C};{\vartheta}} }
}
\rulerCmdDef{rules4.TS.expr.base.e.int}{%
\rulerRule{e.int}{TS}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Int}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{int})} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.char}{%
\rulerRule{e.char}{TS}
{%
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Conid{Char}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection \Varid{char})} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.var}{%
\rulerRule{e.var}{TS}
{%
\ensuremath{i\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection i)} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.con}{%
\rulerRule{e.con}{TS}
{%
\ensuremath{I\mapsto \sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\in \Gamma } 
\\
\ensuremath{o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma \leadsto \mathcal{C};{\delta}} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\sigma \leadsto \mathcal{C}\;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\delta}\;{\vartheta}\;(\allowforspacecorrection I)} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.app}{%
\rulerRule{e.app}{TS}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.app.f}{%
\rulerRule{e.app.f}{TS}
{%
\ensuremath{\Varid{v},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{o_{str};\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\varpi}\Rightarrow \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\anonymous \Rightarrow \sigma } _{ \ensuremath{\Varid{a}} } \ensuremath{\to \sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{inst-l};\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;\Varid{v}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\Gamma \vdash } ^{ \ensuremath{\pi } } \ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{{\varpi}\leadsto } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\mathbin{:}\anonymous } 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{;\lambda {\vartheta}} _{ \ensuremath{\Varid{f}} } \ensuremath{\;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{a}} }} \ensuremath{\;{\vartheta}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.let}{%
\rulerRule{e.let}{TS}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma ;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\mathbin{:}\Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{t}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{t}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{\equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto {\forall}} \overline{ \ensuremath{\alpha } } \ensuremath{.\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto \sigma )\leftarrow \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,} \overline{ \ensuremath{\alpha } } \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \sigma )\mathbin{-}\Varid{ftv}\;(\allowforspacecorrection \mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{)\mskip1.5mu]} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{\equiv [\mskip1.5mu\allowforspacecorrection \Varid{i}\mapsto \mathcal{C}\;\sigma \mid (\allowforspacecorrection \Varid{i}\mapsto {\exists} } \overline{ \ensuremath{\Varid{v}} } \ensuremath{.\sigma )\leftarrow \Gamma } _{ \ensuremath{\Varid{q}} } \ensuremath{,\mathcal{C}\equiv } \overline{ \ensuremath{\Varid{v}\mapsto \Varid{f}} } \ensuremath{,\Varid{f}} \;\mbox{fresh} \ensuremath{\mskip1.5mu]} 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{q}} }^{ \ensuremath{{\not\exists}} } \ensuremath{,\Gamma } _{ \ensuremath{\Varid{g}} } \ensuremath{;\mathcal{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\sigma \leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;\mathbf{let}} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{d}} }} \ensuremath{\;\mathbf{in}\;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.TS.expr.base.e.lam}{%
\rulerRule{e.lam}{TS}
{%
\ensuremath{\Varid{v}_{1},\Varid{v}_{2},{\varpi}} \;\mbox{fresh} \ensuremath{} 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{{\varpi}\Rightarrow \Varid{v}_{1}\to \Varid{v}_{2}\leq \mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{r}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{;{\delta}} 
\\
\ensuremath{\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{\equiv inst} _{ \ensuremath{\pi } } \ensuremath{(\allowforspacecorrection } \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{)} 
\\
\ensuremath{[\mskip1.5mu\allowforspacecorrection \anonymous \rightsquigarrow } \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\mskip1.5mu]\equiv \Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{} 
\\
\ensuremath{o;[\mskip1.5mu\allowforspacecorrection \mskip1.5mu],\Gamma ;\mathcal{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\Varid{v}_{1}\vdash } ^{ \ensuremath{\Varid{p}} } \ensuremath{\Varid{p}\mathbin{:}\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{;\Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\anonymous } 
\\
\ensuremath{o;\Gamma } _{ \ensuremath{\Varid{i}} } \ensuremath{,\Gamma ;\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{;\Varid{v}_{2}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;{\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathcal{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} \overline{ \ensuremath{\pi } _{ \ensuremath{\Varid{a}} }} \ensuremath{\Rightarrow \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \sigma } _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathcal{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{{\vartheta}} _{ \ensuremath{\Varid{i}} }} \ensuremath{\to \lambda \Varid{p}\to {\vartheta}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.ANN.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.ANN.expr.base.scheme}}{Expression type rules}{rules4.ANN.expr.base}{ANN}
\rulerCmdUse{rules4.ANN.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.ANN.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.C.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.C.expr.base.scheme}}{Expression type rules}{rules4.C.expr.base}{C}
\rulerCmdUse{rules4.C.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.C.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.C.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.C.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.C.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.C.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.C.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.CG.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.CG.expr.base.scheme}}{Expression type rules}{rules4.CG.expr.base}{CG}
\rulerCmdUse{rules4.CG.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.CG.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.DT.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.DT.expr.base.scheme}}{Expression type rules}{rules4.DT.expr.base}{DT}
\rulerCmdUse{rules4.DT.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.DT.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.E.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.E.expr.base.scheme}}{Expression type rules}{rules4.E.expr.base}{E}
\rulerCmdUse{rules4.E.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.E.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.E.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.E.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.E.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.E.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.EP.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.EP.expr.base.scheme}}{Expression type rules}{rules4.EP.expr.base}{EP}
\rulerCmdUse{rules4.EP.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.EP.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.EX.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.EX.expr.base.scheme}}{Expression type rules}{rules4.EX.expr.base}{EX}
\rulerCmdUse{rules4.EX.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.EX.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.HM.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.HM.expr.base.scheme}}{Expression type rules}{rules4.HM.expr.base}{HM}
\rulerCmdUse{rules4.HM.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.HM.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.HM.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.HM.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.HM.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.HM.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.HM.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.HS.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.HS.expr.base.scheme}}{Expression type rules}{rules4.HS.expr.base}{HS}
\rulerCmdUse{rules4.HS.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.HS.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.I1.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.I1.expr.base.scheme}}{Expression type rules}{rules4.I1.expr.base}{I1}
\rulerCmdUse{rules4.I1.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.I1.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.I2.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.I2.expr.base.scheme}}{Expression type rules}{rules4.I2.expr.base}{I2}
\rulerCmdUse{rules4.I2.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.K.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.K.expr.base.scheme}}{Expression type rules}{rules4.K.expr.base}{K}
\rulerCmdUse{rules4.K.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.K.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.K.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.K.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.K.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.K.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.K.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.MD.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.MD.expr.base.scheme}}{Expression type rules}{rules4.MD.expr.base}{MD}
\rulerCmdUse{rules4.MD.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.MD.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.NUM.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.NUM.expr.base.scheme}}{Expression type rules}{rules4.NUM.expr.base}{NUM}
\rulerCmdUse{rules4.NUM.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.NUM.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.P.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.P.expr.base.scheme}}{Expression type rules}{rules4.P.expr.base}{P}
\rulerCmdUse{rules4.P.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.P.expr.base.e.lam}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.TS.expr.base}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.TS.expr.base.scheme}}{Expression type rules}{rules4.TS.expr.base}{TS}
\rulerCmdUse{rules4.TS.expr.base.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.let}
\hspace{1ex}
\rulerCmdUse{rules4.TS.expr.base.e.lam}
\end{rulerRulesetFigure}
}

\rulerCmdDef{rules4.I2.expr.impr.scheme}{%
\ensuremath{\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\mathbb{\bbsigma}\leadsto \mathbb{C}} }
}
\rulerCmdDef{rules4.I2.expr.impr.e.int}{%
\rulerRule{e.int}{I2}
{%
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{int}\mathbin{:}\Conid{Int}\leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.char}{%
\rulerRule{e.char}{I2}
{%
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{char}\mathbin{:}\Conid{Char}\leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.var}{%
\rulerRule{e.var}{I2}
{%
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{i\mathbin{:}\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.con}{%
\rulerRule{e.con}{I2}
{%
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{I\mathbin{:}\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{g}} } \ensuremath{\leadsto \mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.app}{%
\rulerRule{e.app}{I2}
{%
\ensuremath{{\cdot};{\cdot};\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\cdot}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{im}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{(\allowforspacecorrection \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{)\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{{\cdot};{\cdot};\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\cdot}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{\textit{fi}_{alt}^{+},o_{inst-l}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\Varid{v}\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{} 
\\
\ensuremath{\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\equiv \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.app.f}{%
\rulerRule{e.app.f}{I2}
{%
\ensuremath{{\cdot};{\cdot};\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\cdot}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{} 
\\
\ensuremath{o_{im}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{f}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{(\allowforspacecorrection \Varid{v}\to \sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{)\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{{\cdot};{\cdot};\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{f}} } \ensuremath{;{\cdot}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
\\
\ensuremath{o_{im}\vdash } ^{ \ensuremath{\leq } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{a}} } \ensuremath{\leq \mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{\Varid{v}\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{} 
\\
\ensuremath{\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\equiv \mathbb{C}} _{ \ensuremath{\Conid{A}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{a}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\;\mathord{\sim}\Varid{e}} _{ \ensuremath{\mathrm{2}} } \ensuremath{\mathbin{:}\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.lam}{%
\rulerRule{e.lam}{I2}
{%
\ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{,\anonymous \equiv \Gamma } _{ \ensuremath{\Varid{p}} } \ensuremath{} 
\\
\ensuremath{} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \Gamma )} 
\\
\ensuremath{o_{meet};\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{} \stackrel{ \ensuremath{\varphi \;\Varid{elim}} }{ \ensuremath{\vdash } } \ensuremath{\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\sigma } _{ \ensuremath{\Varid{e}} }^{ \ensuremath{\Varid{k}} } \ensuremath{\leadsto \anonymous } 
\\
\ensuremath{\textit{fi}_{r-bind}^{+},o\vdash } ^{ \ensuremath{\leq } } \ensuremath{\Varid{v}_{1}\to \Varid{v}_{2}\leq \sigma } _{ \ensuremath{\Varid{e}} }^{ \ensuremath{\Varid{k}} } \ensuremath{\mathbin{:}\anonymous \leadsto \mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{} 
\\
\ensuremath{{\cdot};{\cdot};\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\mathbb{C}} _{ \ensuremath{\Conid{F}} } \ensuremath{\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;{\cdot}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{e}\mathbin{:}\mathbb{\bbsigma}} _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
\\
\ensuremath{o_{meet};\mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{} \stackrel{ \ensuremath{\Gamma \;\varphi \;\Varid{elim}} }{ \ensuremath{\vdash } } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{} 
\\
\ensuremath{\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\equiv \mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\lambda \Varid{p}\to \Varid{e}\mathbin{:}\mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{\sigma } _{ \ensuremath{\Varid{p}} } \ensuremath{\to \mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathbb{\bbsigma}} _{ \ensuremath{\Varid{e}} } \ensuremath{\leadsto \mathbb{C}} _{ \ensuremath{\mathrm{1}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr.e.let}{%
\rulerRule{e.let}{I2}
{%
\ensuremath{} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{\equiv \Varid{ftv}\;(\allowforspacecorrection \Gamma )} 
\\
\ensuremath{\mathcal{C}} _{ \ensuremath{\Varid{p}} } \ensuremath{\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{d}} } \ensuremath{\Varid{d}\leadsto \mathbb{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{} 
\\
\ensuremath{o_{join};\mathbb{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;} \overline{ \ensuremath{\Varid{v}} _{ \ensuremath{\Varid{g}} }} \ensuremath{} \stackrel{ \ensuremath{\Gamma \;\varphi \;\Varid{elim}} }{ \ensuremath{\vdash } } \ensuremath{\Gamma } _{ \ensuremath{\Varid{l}} } \ensuremath{\mathbin{:}\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{} 
\\
\ensuremath{{\cdot};{\cdot};\mathcal{C}} _{ \ensuremath{\Gamma } } \ensuremath{\mathbb{C}} _{ \ensuremath{\Varid{d}} } \ensuremath{;{\cdot}\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\Varid{b}\mathbin{:}\mathbb{\bbsigma}\leadsto \mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
{%
\ensuremath{o;\Gamma ;\mathbb{C}} ^{ \ensuremath{\Varid{k}} } \ensuremath{;\sigma } ^{ \ensuremath{\Varid{k}} } \ensuremath{\vdash } ^{ \ensuremath{\Varid{e}} } \ensuremath{\mathbf{let}\;\Varid{d}\;\mathbf{in}\;\Varid{b}\mathbin{:}\mathbb{\bbsigma}\leadsto \mathbb{C}} _{ \ensuremath{\Varid{e}} } \ensuremath{} 
}
}

\rulerCmdDef{rules4.I2.expr.impr}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.I2.expr.impr.scheme}}{Expression (quantifier propagation) type rules}{rules4.I2.expr.impr}{I2}
\rulerCmdUse{rules4.I2.expr.impr.e.int}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.char}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.var}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.con}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.app}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.app.f}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.lam}
\hspace{1ex}
\rulerCmdUse{rules4.I2.expr.impr.e.let}
\end{rulerRulesetFigure}
}

\rulerCmdDef{rules4.ANN.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.ANN.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{ANN}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.C.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.C.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{C}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.CG.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.CG.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{CG}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.DT.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.DT.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{DT}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.E.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.E.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{E}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.EP.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.EP.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{EP}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.EX.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.EX.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{EX}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.HM.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.HM.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{HM}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.HS.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.HS.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{HS}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.I1.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.I1.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{I1}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.I2.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.I2.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{I2}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.K.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.K.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{K}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.MD.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.MD.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{MD}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.NUM.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.NUM.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{NUM}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.P.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.P.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{P}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.TS.expr.invisible.scheme}{%
\ensuremath{\ensuremath{\Theta ;\Conid{Delta}\vdash } }
}
\rulerCmdDef{rules4.TS.expr.invisible.e.invisible}{%
\rulerRule{e.invisible}{TS}
{%
}
{%
\ensuremath{\Theta ;\Conid{Delta}\vdash } 
}
}

\rulerCmdDef{rules4.ANN.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.ANN.expr.invisible.scheme}}{}{rules4.ANN.expr.invisible}{ANN}
\rulerCmdUse{rules4.ANN.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.C.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.C.expr.invisible.scheme}}{}{rules4.C.expr.invisible}{C}
\rulerCmdUse{rules4.C.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.CG.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.CG.expr.invisible.scheme}}{}{rules4.CG.expr.invisible}{CG}
\rulerCmdUse{rules4.CG.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.DT.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.DT.expr.invisible.scheme}}{}{rules4.DT.expr.invisible}{DT}
\rulerCmdUse{rules4.DT.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.E.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.E.expr.invisible.scheme}}{}{rules4.E.expr.invisible}{E}
\rulerCmdUse{rules4.E.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.EP.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.EP.expr.invisible.scheme}}{}{rules4.EP.expr.invisible}{EP}
\rulerCmdUse{rules4.EP.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.EX.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.EX.expr.invisible.scheme}}{}{rules4.EX.expr.invisible}{EX}
\rulerCmdUse{rules4.EX.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.HM.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.HM.expr.invisible.scheme}}{}{rules4.HM.expr.invisible}{HM}
\rulerCmdUse{rules4.HM.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.HS.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.HS.expr.invisible.scheme}}{}{rules4.HS.expr.invisible}{HS}
\rulerCmdUse{rules4.HS.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.I1.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.I1.expr.invisible.scheme}}{}{rules4.I1.expr.invisible}{I1}
\rulerCmdUse{rules4.I1.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.I2.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.I2.expr.invisible.scheme}}{}{rules4.I2.expr.invisible}{I2}
\rulerCmdUse{rules4.I2.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.K.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.K.expr.invisible.scheme}}{}{rules4.K.expr.invisible}{K}
\rulerCmdUse{rules4.K.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.MD.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.MD.expr.invisible.scheme}}{}{rules4.MD.expr.invisible}{MD}
\rulerCmdUse{rules4.MD.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.NUM.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.NUM.expr.invisible.scheme}}{}{rules4.NUM.expr.invisible}{NUM}
\rulerCmdUse{rules4.NUM.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.P.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.P.expr.invisible.scheme}}{}{rules4.P.expr.invisible}{P}
\rulerCmdUse{rules4.P.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}
\rulerCmdDef{rules4.TS.expr.invisible}{%
\begin{rulerRulesetFigure}{\rulerCmdUse{rules4.TS.expr.invisible.scheme}}{}{rules4.TS.expr.invisible}{TS}
\rulerCmdUse{rules4.TS.expr.invisible.e.invisible}
\end{rulerRulesetFigure}
}

